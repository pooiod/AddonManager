<!DOCTYPE html>

<html>
<head>
    <title>Documentation - ScriptKitten</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;700&family=Lato:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <style>
        :root {
            --primary-color: #007BFF;
            --accent-color: #0056b3;
            --background-color: #F8F9FA;
            --text-color: #212529;
            --subtle-gray: #E9ECEF;
            --card-background: #FFFFFF;
        }

        *,
        *::before,
        *::after {
            box-sizing: border-box;
        }

        html,
        body {
            height: 100%;
        }

        body {
            font-family: 'Lato', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.7;
            display: flex;
            flex-direction: column;
        }

        a {
            color: #207bac;
        }
        a:hover {
            color: #ff6b00;
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: 'Poppins', sans-serif;
            font-weight: 700;
            line-height: 1.2;
        }

        header {
            background-color: var(--card-background);
            padding: 1rem 0;
            flex-shrink: 0;
        }

        header .container {
            /* max-width: 1400px; */
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        header h1 {
            margin: 0;
            font-size: 1.8rem;
            color: var(--primary-color);
        }
        
        #menu-toggle {
            display: none;
            background: none;
            border: 2px solid var(--subtle-gray);
            border-radius: 8px;
            padding: 8px 12px;
            font-family: 'Poppins', sans-serif;
            font-weight: 700;
            cursor: pointer;
            color: var(--text-color);
            margin-right: 15px;
        }

        nav a {
            color: var(--text-color);
            text-decoration: none;
            margin-left: 15px;
            font-weight: 700;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            transition: color 0.2s, background-color 0.2s;
            border: 2px solid transparent;
            padding: 8px 15px;
            border-radius: 8px;
        }

        nav a:hover,
        nav a:focus {
            background-color: var(--subtle-gray);
            color: var(--primary-color);
            outline: none;
        }

        .content-wrapper {
            display: flex;
            flex-grow: 1;
            overflow: hidden;
            background-color: var(--card-background);
        }

        #sidebar {
            width: 280px;
            flex-shrink: 0;
            padding: 2rem;
            overflow-y: auto;
            transition: max-height 0.3s ease-out, padding 0.3s ease-out;
        }

        #sidebar-nav {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        #sidebar-nav li a {
            display: block;
            padding: 10px 15px;
            text-decoration: none;
            color: var(--text-color);
            font-weight: 700;
            border-radius: 8px;
            transition: background-color 0.2s, color 0.2s;
        }

        #sidebar-nav li a:hover {
            background-color: var(--subtle-gray);
        }

        #sidebar-nav li a.active {
            background-color: var(--primary-color);
            color: white;
        }

        #main-content {
            flex-grow: 1;
            padding: 2rem 3rem;
            overflow-y: auto;
            background-color: var(--background-color);
            border-left: 2px solid var(--subtle-gray);
            border-top: 2px solid var(--subtle-gray);
        }

        #docs-article {
            max-width: 800px;
            margin: 0 auto;
        }

        #docs-article h1,
        #docs-article h2,
        #docs-article h3 {
            border-bottom: 2px solid var(--subtle-gray);
            padding-bottom: 10px;
            margin-top: 2rem;
        }

        #docs-article pre {
            background-color: #f6f8fa;
            padding: 16px;
            overflow: auto;
            line-height: 1.45;
            border-radius: 6px;
            position: relative;
            border: 1px solid #ddd;
        }

        #docs-article pre code.hljs {
            padding: 0;
            margin: 0;
            font-size: 100%;
            background-color: transparent;
        }

        .copy-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            background-color: #555;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 5px;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.2s, background-color 0.2s;
            font-size: 12px;
            font-family: sans-serif;
        }
        
        #docs-article pre:hover .copy-btn {
            opacity: 1;
        }
        
        .copy-btn:hover {
            background-color: #000;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid var(--subtle-gray);
            border-top-color: var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 4rem auto;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        @media (max-width: 768px) {
            .content-wrapper {
                flex-direction: column;
            }
            
            header .container {
                justify-content: flex-end;
            }

            header h1 {
                display: none;
            }

            #menu-toggle {
                display: block;
                order: -1; 
                margin-left: 0;
                margin-right: auto;
            }

            #sidebar {
                width: 100%;
                border-bottom: 2px solid var(--subtle-gray);
                max-height: 0;
                padding-top: 0;
                padding-bottom: 0;
                overflow-y: hidden;
            }

            #sidebar.is-open {
                max-height: 50vh;
                padding: 2rem;
                overflow-y: auto;
            }

            #main-content {
                border-left: none;
                padding: 2rem 1.5rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>ScriptKitten</h1>
            <button id="menu-toggle">Menu</button>
            <nav>
                <a href="/">Home</a>
                <a href="/addons">Community Addons</a>
            </nav>
        </div>
    </header>
    <div class="content-wrapper">
        <aside id="sidebar">
            <ul id="sidebar-nav">
            </ul>
        </aside>
        <main id="main-content">
            <article id="docs-article">
                <div class="spinner"></div>
            </article>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const sidebarNav = document.getElementById('sidebar-nav');
            const docsArticle = document.getElementById('docs-article');
            const menuToggle = document.getElementById('menu-toggle');
            const sidebar = document.getElementById('sidebar');

            const repo = 'pooiod/ScriptKitten';
            const docsPath = 'docs';

            menuToggle.addEventListener('click', () => {
                sidebar.classList.toggle('is-open');
            });
            
            sidebar.addEventListener('click', (e) => {
                if (e.target.tagName === 'A' && window.innerWidth <= 768) {
                    sidebar.classList.remove('is-open');
                }
            });

            function formatFileName(filename) {
                return filename
                    .replace(/\.md$/, '')
                    .replace(/-/g, ' ')
                    .replace(/\b\w/g, char => char.toUpperCase());
            }

            function addCopyButtons() {
                docsArticle.querySelectorAll('pre').forEach(pre => {
                    if (pre.querySelector('.copy-btn')) return;

                    const code = pre.querySelector('code');
                    if (code) {
                        const copyButton = document.createElement('button');
                        copyButton.innerText = 'Copy';
                        copyButton.classList.add('copy-btn');
                        
                        copyButton.addEventListener('click', () => {
                            navigator.clipboard.writeText(code.innerText).then(() => {
                                copyButton.innerText = 'Copied!';
                                setTimeout(() => {
                                    copyButton.innerText = 'Copy';
                                }, 2000);
                            });
                        });
                        pre.appendChild(copyButton);
                    }
                });
            }

            async function loadSidebar() {
                try {
                    const files = [
                        "intro.md",
                        "addon-structure.md",
                        "getInfo.md",
                        "events.md", 
                        "addon-options.md",
                        "ui-widgets.md",
                        "theming.md",
                        "globals.md",
                        "custom-apis.md"
                    ];

                    const mdFiles = files.filter(file => file.endsWith('.md') && !file.startsWith('!'));

                    sidebarNav.innerHTML = mdFiles.map(file => {
                        const cleanName = file.replace('.md', '');
                        return `<li><a href="#/${cleanName}" data-filename="${file}">${formatFileName(file)}</a></li>`;
                    }).join('');
                } catch (error) {
                    console.error('Error loading sidebar:', error);
                    sidebarNav.innerHTML = '<li><a>Error loading navigation</a></li>';
                }
            }

            async function loadContent(filename) {
                try {
                    docsArticle.innerHTML = '<div class="spinner"></div>';
                    const response = await fetch(`./${filename}`);
                    if (!response.ok) throw new Error(`404: File not found`);

                    const markdownText = await response.text();

                    if (markdownText.includes("75924")) {
                        throw new Error(`404: File not found`);
                    }

                    docsArticle.innerHTML = marked.parse(markdownText);
                    
                    hljs.highlightAll();
                    
                    addCopyButtons();

                    document.querySelectorAll('#sidebar-nav li a').forEach(link => {
                        link.classList.toggle('active', link.dataset.filename === filename);
                    });

                } catch (error) {
                    console.error('Error loading content:', error);
                    var page = filename.replace(".md", "");
                    docsArticle.innerHTML = `<h1>🛑 Oh no! That page doesn't exist.</h1>
<img src="/images/filenotfound.png" alt="A picture of a confused robot holding a map">
<p>It seems you've navigated to a page that doesn't exist. The document you were looking for might have been moved, renamed, or it never existed in the first place.</p>

<p style="margin-bottom: -10px;">Here are a few things you can try:</p>
<ul>
  <li><strong>Check the URL:</strong> Make sure there are no typos in the address.</li>
  <li><strong>Go Back:</strong> Use your browser's back button to return to the previous page.</li>
  <li><strong>Use the Navigation:</strong> Select a valid page from the sidebar navigation.</li>
  <li><strong>Return Home:</strong> Visit the <a href="#/intro">home page</a>.</li>
</ul>

<p>If you believe this is an error and the page should exist, please feel free to report an issue <a href="https://github.com/pooiod/ScriptKitten/issues">here</a>.</p>`;
                }
            }

            function handleRouteChange() {
                const hash = window.location.hash.substring(2);
                const filename = hash ? `${hash}.md` : 'intro.md';
                loadContent(filename);
            }

            window.addEventListener('hashchange', handleRouteChange);

            async function initialize() {
                await loadSidebar();
                handleRouteChange();
            }

            initialize();

            window.addEventListener('hashchange', () => {
                location.reload()
            })
        });
    </script>
</body>
</html>
